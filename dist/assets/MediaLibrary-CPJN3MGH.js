import{j as e}from"./ui-BLUv2tW2.js";import{a as t}from"./vendor-f9TeDfvc.js";import{c as C,s as l,u as r}from"./index-DJcS8j5y.js";import{B as p}from"./button-BMVttRVi.js";import{C as U,a as L}from"./card-CnFkVFlP.js";import{I as k}from"./input-BKXVYl-h.js";import{L as x}from"./loader-circle-Fum6eH1W.js";import{U as I}from"./upload-DC7hBDPV.js";import{C as E}from"./check-CpBXVeWG.js";import{T as M}from"./trash-2-Bjhfi4SH.js";import"./utils-73O3M1Kq.js";const S=C("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),W=()=>{const[h,g]=t.useState([]),[j,y]=t.useState(!0),[c,u]=t.useState(!1),[b,f]=t.useState(null);t.useEffect(()=>{n()},[]);const n=async()=>{try{const{data:a,error:s}=await l.storage.from("media").list();if(s)throw s;const d=await Promise.all((a||[]).map(async i=>{const{data:{publicUrl:m}}=l.storage.from("media").getPublicUrl(i.name);return{name:i.name,url:m,created_at:i.created_at}}));g(d)}catch(a){console.error("Error fetching media:",a)}finally{y(!1)}},N=async a=>{if(!a.target.files||a.target.files.length===0)return;u(!0);const s=a.target.files[0],d=s.name.split(".").pop(),m=`${`${Math.random().toString(36).substring(2)}.${d}`}`;try{const{error:o}=await l.storage.from("media").upload(m,s);if(o)throw o;r.success("Image uploaded"),n()}catch(o){r.error(o.message||"Upload failed")}finally{u(!1)}},v=async a=>{if(confirm("Delete this image?"))try{const{error:s}=await l.storage.from("media").remove([a]);if(s)throw s;r.success("Image deleted"),n()}catch{r.error("Failed to delete image")}},w=a=>{navigator.clipboard.writeText(a),f(a),r.success("URL copied to clipboard"),setTimeout(()=>f(null),2e3)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Media Library"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{type:"file",className:"hidden",id:"file-upload",accept:"image/*",onChange:N,disabled:c}),e.jsx("label",{htmlFor:"file-upload",children:e.jsx(p,{className:"bg-brand-blue hover:bg-brand-blue/90 cursor-pointer",asChild:!0,disabled:c,children:e.jsxs("span",{children:[c?e.jsx(x,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(I,{className:"w-4 h-4 mr-2"}),"Upload Image"]})})})]})]}),j?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(x,{className:"w-8 h-8 animate-spin text-brand-blue"})}):h.length===0?e.jsx("div",{className:"text-center py-12 text-slate-500 border-2 border-dashed rounded-lg",children:"No images found. Upload one to get started."}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:h.map(a=>e.jsxs(U,{className:"overflow-hidden group",children:[e.jsxs("div",{className:"aspect-square relative bg-slate-100",children:[e.jsx("img",{src:a.url,alt:a.name,className:"w-full h-full object-cover"}),e.jsxs("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[e.jsx(p,{variant:"secondary",size:"icon",onClick:()=>w(a.url),children:b===a.url?e.jsx(E,{className:"w-4 h-4"}):e.jsx(S,{className:"w-4 h-4"})}),e.jsx(p,{variant:"destructive",size:"icon",onClick:()=>v(a.name),children:e.jsx(M,{className:"w-4 h-4"})})]})]}),e.jsx(L,{className:"p-3",children:e.jsx("p",{className:"text-xs text-slate-500 truncate",title:a.name,children:a.name})})]},a.name))})]})};export{W as default};
